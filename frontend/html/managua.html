<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width,initial-scale=1">
  <title>Panel - Managua | SnackCity</title>
  <link rel="stylesheet" href="../css/styles.css">
  <!-- user-session module populates common fields -->
  <script type="module" src="/js/user-session.mjs" defer></script>
</head>
<body class="app-page">
  <header class="app-header">
    <div class="container">
      <h1 id="userName">Usuario</h1>
      <div class="user-meta">
        <span class="user-role" id="userRole">Rol</span>
        <span class="user-department" id="userDept">Departamento</span>
      </div>
      <button id="logout" class="btn btn-secondary">Cerrar sesión</button>
    </div>
  </header>

  <main class="container">
    <h2>Panel - Managua</h2>
    <p>Esta es una página de ejemplo para el rol/ubicación "Managua". Aquí irán widgets, gráficos y accesos rápidos.</p>

    <section id="profileCard" class="card">
      <h3>Mi perfil</h3>
      <ul>
        <li><strong>Nombre:</strong> <span id="pfName">-</span></li>
        <li><strong>Correo:</strong> <span id="pfEmail">-</span></li>
        <li><strong>Rol:</strong> <span id="pfRole">-</span></li>
        <li><strong>Sucursal / Departamento:</strong> <span id="pfDept">-</span></li>
      </ul>
    </section>
  </main>

  <script type="module">
    import { requireAuth } from '/js/user-session.mjs';
    import { getAuth, signOut } from 'https://www.gstatic.com/firebasejs/9.22.0/firebase-auth.js';

    document.addEventListener('DOMContentLoaded', async () => {
      const profile = await requireAuth('/index.html');
      if (!profile) return; // redirect handled by requireAuth

      // fill profile card
      document.getElementById('pfName').textContent = profile.nombre || profile.name || '-';
      document.getElementById('pfEmail').textContent = profile.correo || profile.email || '-';
      document.getElementById('pfRole').textContent = profile.rol || '-';
      document.getElementById('pfDept').textContent = profile.departamento || profile.sucursal || '-';

      // logout
      const logoutBtn = document.getElementById('logout');
      logoutBtn.addEventListener('click', async () => {
        try {
          await signOut(getAuth());
          window.location.href = '/index.html';
        } catch (err) {
          console.error('Error signOut', err);
        }
      });
    });
  </script>
</body>
</html>
<!doctype html>
<html lang="es">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Página eliminada</title>
    <link rel="stylesheet" href="../css/styles.css">
  </head>
  <body>
    <h1>Contenido eliminado</h1>
    <p>Esta página fue retirada porque no forma parte del flujo de login.</p>
    <p><a href="/">Volver al login</a></p>
  </body>
</html>
              <div class="card-header">
                <h2>Inventario Bajo</h2>
                <button class="btn btn-sm btn-link">Ver todo</button>
              </div>
              <div class="card-body">
                <div class="alert-list">
                  <div class="alert-item">
                    <div class="alert-icon">
                      <i class="fas fa-exclamation-triangle"></i>
                    </div>
                    <div class="alert-content">
                      <h4>Coca-Cola 3L</h4>
                      <p>Quedan 15 unidades</p>
                    </div>
                    <button class="btn btn-sm btn-outline">Reabastecer</button>
                  </div>
                  <div class="alert-item">
                    <div class="alert-icon">
                      <i class="fas fa-exclamation-triangle"></i>
                    </div>
                    <div class="alert-content">
                      <h4>Sprite 2.5L</h4>
                      <p>Quedan 8 unidades</p>
                    </div>
                    <button class="btn btn-sm btn-outline">Reabastecer</button>
                  </div>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
  </main>

  <!-- Scripts al final del body -->
  <script src="../js/sucursales.js"></script>
  <script>
    // Toggle sidebar en móviles
    document.getElementById('toggleSidebarBtn').addEventListener('click', function () {
      document.querySelector('.sidebar').classList.toggle('show');
    });

    // Cerrar sidebar al hacer clic fuera de él
    document.addEventListener('click', function (event) {
      const sidebar = document.querySelector('.sidebar');
      const toggleBtn = document.getElementById('toggleSidebarBtn');

      if (window.innerWidth <= 992 && !sidebar.contains(event.target) && !toggleBtn.contains(event.target)) {
        sidebar.classList.remove('show');
      }
    });

    // Actualizar nombre de usuario
    document.addEventListener('DOMContentLoaded', function () {
      const userName = localStorage.getItem('userName') || 'Usuario';
      document.querySelectorAll('#userName').forEach(el => {
        el.textContent = userName;
      });
    });
  </script>
</body>

</html>